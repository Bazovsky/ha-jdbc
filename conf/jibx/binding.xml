<?xml version="1.0"?>
<!--DOCTYPE binding SYSTEM "binding.dtd"-->
<binding>
	<mapping name="ha-jdbc" class="net.sf.hajdbc.DatabaseClusterFactory">
		<structure name="distributable" field="builder" type="net.sf.hajdbc.distributable.DistributableDatabaseClusterBuilder" usage="optional">
			<value name="config" get-method="getConfig" set-method="setConfig" style="attribute" usage="optional" default="stacks.xml"/>
			<value name="stack" field="stack" style="attribute" usage="optional" default="fc-fast-minimalthreads"/>
			<value name="timeout" field="timeout" style="attribute" usage="optional" default="1000"/>
		</structure>
		<collection add-method="addSynchronizationStrategyBuilder" iter-method="getSynchronizationStrategyBuilders" item-type="net.sf.hajdbc.SynchronizationStrategyBuilder"></collection>
		<collection add-method="addDatabaseCluster" iter-method="getDatabaseClusters" item-type="net.sf.hajdbc.DatabaseCluster"></collection>
	</mapping>
	<mapping name="sync" class="net.sf.hajdbc.SynchronizationStrategyBuilder">
		<value name="id" field="id" style="attribute" ident="def"/>
		<value name="class" field="className" style="attribute"/>
		<structure field="properties" unmarshaller="net.sf.hajdbc.util.PropertiesMapper" marshaller="net.sf.hajdbc.util.PropertiesMapper"></structure>
	</mapping>
	<mapping name="cluster" class="net.sf.hajdbc.local.LocalDatabaseCluster" factory="net.sf.hajdbc.DatabaseClusterFactory.createDatabaseCluster">
		<value name="id" field="id" style="attribute"/>
		<value name="balancer" field="balancer" style="attribute" deserializer="net.sf.hajdbc.balancer.BalancerFactory.deserialize" serializer="net.sf.hajdbc.balancer.BalancerFactory.serialize"/>
		<value name="default-sync" get-method="getDefaultSynchronizationStrategyBuilder" set-method="setDefaultSynchronizationStrategyBuilder" style="attribute" ident="ref"/>
		<value name="dialect" field="dialect" style="attribute" deserializer="net.sf.hajdbc.dialect.DialectFactory.deserialize" serializer="net.sf.hajdbc.dialect.DialectFactory.serialize" usage="optional"/>
		<value name="meta-data-cache" field="databaseMetaDataCache" style="attribute" deserializer="net.sf.hajdbc.cache.DatabaseMetaDataCacheFactory.deserialize" serializer="net.sf.hajdbc.cache.DatabaseMetaDataCacheFactory.serialize" usage="required"/>
		<value name="transactions" field="transaction" style="attribute" deserializer="net.sf.hajdbc.local.Transaction.deserialize" serializer="net.sf.hajdbc.local.Transaction.serialize"/>
		<value name="auto-activate-schedule" field="autoActivationSchedule" style="attribute" usage="optional"/>
		<value name="failure-detect-schedule" field="failureDetectionSchedule" style="attribute" usage="optional"/>
		<value name="min-threads" field="minThreads" usage="optional" default="0"/>
		<value name="max-threads" field="maxThreads" usage="optional" default="100"/>
		<value name="max-idle" field="maxIdle" style="attribute" usage="optional" default="60"/>
		<value name="detect-sequences" field="sequenceDetectionEnabled" style="attribute" usage="optional" default="true"/>
		<value name="detect-auto-increment-columns" field="autoIncrementDetectionEnabled" style="attribute" usage="optional" default="true"/>
		<collection add-method="add" iter-method="getDriverDatabases" item-type="net.sf.hajdbc.sql.DriverDatabase"></collection>
		<collection add-method="add" iter-method="getDataSourceDatabases" item-type="net.sf.hajdbc.sql.DataSourceDatabase"></collection>
	</mapping>
	<mapping class="net.sf.hajdbc.sql.AbstractDatabase" abstract="true">
		<value name="id" field="id" style="attribute"/>
		<value name="weight" field="weight" style="attribute" usage="optional" default="1"/>
		<structure field="properties" unmarshaller="net.sf.hajdbc.util.PropertiesMapper" marshaller="net.sf.hajdbc.util.PropertiesMapper"></structure>
		<value name="user" field="user" usage="optional"/>
		<value name="password" field="password" usage="optional"/>
	</mapping>
	<mapping name="database" class="net.sf.hajdbc.sql.DriverDatabase" extends="net.sf.hajdbc.sql.AbstractDatabase">
		<value name="driver" field="driverClass" usage="optional" serializer="net.sf.hajdbc.sql.DriverDatabase.getClassName" deserializer="net.sf.hajdbc.sql.DriverDatabase.forName"/>
		<value name="url" field="url"/>
		<structure map-as="net.sf.hajdbc.sql.AbstractDatabase"></structure>
	</mapping>
	<mapping name="datasource" class="net.sf.hajdbc.sql.DataSourceDatabase" extends="net.sf.hajdbc.sql.AbstractDatabase">
		<value name="name" field="name"/>
		<structure map-as="net.sf.hajdbc.sql.AbstractDatabase"></structure>
	</mapping>
</binding>
